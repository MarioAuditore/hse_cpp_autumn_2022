Format function with a bit of variadic templates and cases for throw function
